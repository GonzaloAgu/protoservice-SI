<!DOCTYPE html>
<html lang="es">

<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Electroservice</title>
  <link rel="stylesheet" href="/styles/bootstrap.css">
  <link rel="stylesheet" href="./styles/styles.css">
  <link rel="icon" type="image/x-icon" href="../styles/icon.png">
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css">
  <script type="module" src="./views/src/reparacion.js"></script>
  <script src="./views/src/jquery-3.7.1.js"></script>
  <script src="./views/components/navbar.js"></script>
  <script type="module" src="./views/components/reparacionView.js"></script>
  <script src="./views/src/bootstrap.bundle.min.js"></script>

</head>

<body data-bs-theme="dark">
  <div class="container">
    <!-- Título principal -->
    <h1 id="title" class="text-center my-4 text-danger">ELECTROSERVICE</h1>

    <!-- Barra de navegación -->
    <nav-bar></nav-bar>

    <!-- Spinner usado en caso de eliminación -->
     <div id="spinner-container" class="w-100 d-flex justify-content-center d-none mt-5">
       <div class="spinner-grow " style="width: 4rem; height: 4rem;" role="status">
         <span class="visually-hidden">Loading...</span>
       </div>
     </div>

    <div class="card shadow-sm d-none">

      <div class="card-header d-flex justify-content-between text-white px-3">
        <h4 class="my-1">Reparación #<span id="nro-reparacion-title"></span> </h4> <!-- Número de reparación -->
        <button class="btn btn-danger btn-sm" id="btn-eliminar"  data-bs-toggle="modal" data-bs-target="#eliminar-warning">
          Eliminar
        </button>
      </div>
      
      <div class="card-body">
        <rep-view id="rep-view" estado="pendiente"></rep-view>

        <div class="my-2">
          <ul class="list-group list-group-flush" id="lista-comentarios">
          </ul>
        </div>

        <div class="d-flex justify-content-end align-items-center">
          <div class="input-group me-2">
            <input placeholder="Ingresar una nota a la reparación..." type="text" id="input-comentario"
              class="form-control" maxlength="500">
            <button type="submit" id="btn-comentario" class="input-group-text" title="Agregar nota a la reparación">
              <i class="fa fa-arrow-right" aria-hidden="true"> </i>
            </button>
          </div>
          <div class="btn-group dropup me-2">
            <button type="button" class="btn btn-secondary dropdown-toggle" data-bs-toggle="dropdown"
              aria-expanded="false">
              Cambiar estado
            </button>
            <ul class="dropdown-menu p-3">
              <li class="form-check  item-estado">
                <input class="form-check-input" type="radio" name="estado" value="0" id="opc-pendiente">
                <label class="form-check-label item-estado" for="opc-pendiente">
                  Pendiente
                </label>
              </li>
              <li class="form-check">
                <input class="form-check-input" type="radio" name="estado" value="1" id="opc-revision">
                <label class="form-check-label item-estado" for="opc-revision">
                  En revisión
                </label>
              </li>
              <li class="form-check">
                <input class="form-check-input" type="radio" name="estado" value="2" id="opc-reparado">
                <label class="form-check-label item-estado" for="opc-reparado">
                  Reparado
                </label>
              </li>
              <li class="form-check">
                <input class="form-check-input" type="radio" name="estado" value="3" id="opc-sin-arreglo">
                <label class="form-check-label item-estado" for="opc-sin-arreglo">
                  Sin arreglo
                </label>
              </li>
              <li class="text-center">
                <button class="btn btn-primary mt-3" id="btn-actualizar-estado" type="button">Actualizar</button>
              </li>
            </ul>


          </div>
          <button class="btn btn-success" id="btn-generar-factura" style="white-space: nowrap;" data-bs-toggle="modal" data-bs-target="#generar-factura-modal">
            Generar Factura
          </button>
        </div>
      </div>
    </div>
    <div id="errorPopup" class="alert alert-danger m-auto fade" rote="alert"></div>

    <!-- Modal de eliminacion -->
    <div class="modal fade" id="eliminar-warning" data-bs-backdrop="static" data-bs-keyboard="false" tabindex="-1"
      aria-labelledby="staticBackdropLabel" aria-hidden="true">
      <div class="modal-dialog">
        <div class="modal-content">
          <div class="modal-header">
            <h1 class="modal-title fs-5" id="staticBackdropLabel">¿Seguro que desea eliminar la reparación?</h1>
            <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
          </div>
          <div class="modal-body">
            Esto eliminará la reparación del historial.
          </div>
          <div class="modal-footer">
            <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Cancelar</button>
            <button type="button" id="btn-eliminar-confirmado" class="btn btn-danger" data-bs-dismiss="modal">Eliminar</button>
          </div>
        </div>
      </div>
    </div>

    <!-- Modal de generar factura -->
    <div class="modal fade" id="generar-factura-modal" data-bs-backdrop="static" data-bs-keyboard="false" tabindex="-1"
      aria-labelledby="staticBackdropLabel" aria-hidden="true">
      <div class="modal-dialog">
        <div class="modal-content">
          <div class="modal-header">
            <h1 class="modal-title fs-5" id="staticBackdropLabel">Generando factura</h1>
            <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
          </div>
          <div class="modal-body">
            <p>Rellene los campos para generar su factura.</p>
            <form id="generar-factura-form">
              <div class="form-floating mb-2">
                <input required id="monto-input" type="numer" min="0" class="form-control">
                <label for="monto-input" class="form-label">Monto</label>
              </div>
              <div class="form-floating mb-2">
                <select id="tipo-factura-input" class="form-select" required>
                  <option value="A">Factura A</option>
                  <option value="B">Factura B</option>
                  <option value="C">Factura C</option>
                </select>
                <label for="tipo-factura-input" class="form-label">Tipo de factura</label>
              </div>
              <div class="form-floating mb-2">
                <select id="medio-pago-input" class="form-select" required>
                  <option value="1">Efectivo</option>
                  <option value="2">Tarjeta de débito</option>
                  <option value="3">Tarjeta de crédito</option>
                </select>
                <label for="medio-pago-input" class="form-label">Medio de pago</label>
              </div>
            </div>
          </form>
          <div class="modal-footer">
            <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Cancelar</button>
            <button type="button" id="btn-generar-pdf" class="btn btn-primary">Generar PDF</button>
          </div>
          </div>
        </div>
      </div>
    </div>
</body>

</html>